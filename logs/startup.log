
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::               (v2.7.10)

2025-04-21 20:18:40.484 [main] INFO  com.community.waste.WasteClassificationApplication - Starting WasteClassificationApplication v0.0.1-SNAPSHOT using Java 21.0.6 on ChendeMacBook-Air.local with PID 28994 (/Users/torres/Desktop/cursor_workspace/community-waste-classification/target/waste-classification-0.0.1-SNAPSHOT.jar started by torres in /Users/torres/Desktop/cursor_workspace/community-waste-classification)
2025-04-21 20:18:40.485 [main] DEBUG com.community.waste.WasteClassificationApplication - Running with Spring Boot v2.7.10, Spring v5.3.26
2025-04-21 20:18:40.486 [main] INFO  com.community.waste.WasteClassificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-04-21 20:18:40.913 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-04-21 20:18:40.918 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-04-21 20:18:40.918 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.73]
2025-04-21 20:18:41.085 [main] INFO  org.apache.jasper.servlet.TldScanner - At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
2025-04-21 20:18:41.176 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/waste] - Initializing Spring embedded WebApplicationContext
2025-04-21 20:18:41.176 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 669 ms
2025-04-21 20:18:41.312 [main] INFO  com.community.waste.util.DbLogUtil - 数据库连接成功！
2025-04-21 20:18:41.312 [main] INFO  com.community.waste.util.DbLogUtil - 数据库产品名称: MySQL
2025-04-21 20:18:41.312 [main] INFO  com.community.waste.util.DbLogUtil - 数据库产品版本: 8.0.42
2025-04-21 20:18:41.312 [main] INFO  com.community.waste.util.DbLogUtil - 数据库驱动名称: MySQL Connector/J
2025-04-21 20:18:41.313 [main] INFO  com.community.waste.util.DbLogUtil - 数据库驱动版本: mysql-connector-j-8.0.33 (Revision: 7d6b0800528b6b25c68b52dc10d6c1c8429c100c)
2025-04-21 20:18:41.313 [main] INFO  com.community.waste.util.DbLogUtil - 数据库URL: jdbc:mysql://localhost:3306/waste_classification?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true
2025-04-21 20:18:41.319 [main] INFO  com.community.waste.util.DbLogUtil - 数据库用户名: root@localhost
2025-04-21 20:18:41.319 [main] INFO  com.community.waste.util.DbLogUtil - JDBC主版本: 4
2025-04-21 20:18:41.319 [main] INFO  com.community.waste.util.DbLogUtil - JDBC次版本: 2
2025-04-21 20:18:41.319 [main] INFO  com.community.waste.util.DbLogUtil - 数据库连接是否自动提交: true
2025-04-21 20:18:41.319 [main] INFO  com.community.waste.util.DbLogUtil - 数据库连接事务隔离级别: TRANSACTION_REPEATABLE_READ
2025-04-21 20:18:41.319 [main] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT VERSION() as version]
2025-04-21 20:18:41.321 [main] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:18:41.331 [main] INFO  com.community.waste.util.DbLogUtil - MySQL服务器版本: 8.0.42
2025-04-21 20:18:41.331 [main] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT DATABASE() as current_db]
2025-04-21 20:18:41.331 [main] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:18:41.331 [main] INFO  com.community.waste.util.DbLogUtil - 当前数据库: waste_classification
2025-04-21 20:18:41.331 [main] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT TABLE_NAME, TABLE_ROWS, CREATE_TIME, ENGINE FROM information_schema.TABLES WHERE TABLE_SCHEMA = DATABASE() ORDER BY CREATE_TIME]
2025-04-21 20:18:41.331 [main] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 数据库表信息：
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: announcement, 行数: 2, 创建时间: 2025-04-17 20:31:53.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: disposal_record, 行数: 0, 创建时间: 2025-04-17 20:31:53.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: faq, 行数: 11, 创建时间: 2025-04-17 20:31:53.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: user, 行数: 4, 创建时间: 2025-04-17 20:31:53.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: waste_category, 行数: 8, 创建时间: 2025-04-17 20:31:53.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: activity, 行数: 2, 创建时间: 2025-04-17 20:31:54.0, 存储引擎: InnoDB
2025-04-21 20:18:41.346 [main] INFO  com.community.waste.util.DbLogUtil - 表名: waste_record, 行数: 0, 创建时间: 2025-04-20 16:33:07.0, 存储引擎: InnoDB
Logging initialized using 'class org.apache.ibatis.logging.stdout.StdOutImpl' adapter.
Registered plugin: 'com.community.waste.config.SqlMonitorInterceptor@26be6ca7'
Parsed mapper file: 'class path resource [mapper/FaqMapper.xml]'
Parsed mapper file: 'class path resource [mapper/ActivityMapper.xml]'
Parsed mapper file: 'class path resource [mapper/WasteRecordMapper.xml]'
Parsed mapper file: 'class path resource [mapper/WasteCategoryMapper.xml]'
Parsed mapper file: 'class path resource [mapper/UserMapper.xml]'
Parsed mapper file: 'class path resource [mapper/AnnouncementMapper.xml]'
2025-04-21 20:18:41.603 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page template: index
2025-04-21 20:18:41.670 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path '/waste'
2025-04-21 20:18:41.674 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 开始执行数据库连接监控任务
2025-04-21 20:18:41.674 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT COUNT(*) as connections FROM information_schema.PROCESSLIST WHERE DB = DATABASE()]
2025-04-21 20:18:41.674 [scheduling-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:18:41.675 [main] INFO  com.community.waste.WasteClassificationApplication - Started WasteClassificationApplication in 1.371 seconds (JVM running for 1.542)
2025-04-21 20:18:41.689 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - SQLWarning ignored: SQL state 'HY000', error code '1287', message ['INFORMATION_SCHEMA.PROCESSLIST' is deprecated and will be removed in a future release. Please use performance_schema.processlist instead]
2025-04-21 20:18:41.690 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - 当前活动连接数: 5
2025-04-21 20:18:41.690 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 数据库连接监控任务执行完成
2025-04-21 20:18:41.690 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 开始执行数据库性能监控任务
2025-04-21 20:18:41.690 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SHOW GLOBAL STATUS WHERE Variable_name IN ('Threads_connected', 'Threads_running', 'Queries', 'Slow_queries')]
2025-04-21 20:18:41.690 [scheduling-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - 数据库性能指标：
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - Queries: 1069
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - Slow_queries: 0
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - Threads_connected: 5
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - Threads_running: 2
2025-04-21 20:18:41.701 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 数据库性能监控任务执行完成
2025-04-21 20:19:03.048 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/waste] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-04-21 20:19:03.049 [http-nio-8080-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-04-21 20:19:03.049 [http-nio-8080-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-04-21 20:19:34.126 [http-nio-8080-exec-5] INFO  com.community.waste.service.impl.UserServiceImpl - 开始用户名登录流程，用户名: admin
2025-04-21 20:19:34.126 [http-nio-8080-exec-5] DEBUG com.community.waste.service.impl.UserServiceImpl - 根据用户名查询用户: admin
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5179614d] was not registered for synchronization because synchronization is not active
2025-04-21 20:19:34.139 [http-nio-8080-exec-5] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@1531157066 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT id, username, password, phone, email, role, register_time, last_login_time FROM user WHERE username = ?
==> Parameters: admin(String)
<==    Columns: id, username, password, phone, email, role, register_time, last_login_time
<==        Row: 1, admin, e10adc3949ba59abbe56e057f20f883e, 13800000000, admin@example.com, 2, 2025-04-17 20:33:11, 2025-04-18 18:42:32
<==      Total: 1
2025-04-21 20:19:34.171 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT id, username, password, phone, email, role, register_time, last_login_time FROM user WHERE username = 'admin'
2025-04-21 20:19:34.171 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.UserMapper.selectByUsername
2025-04-21 20:19:34.171 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 36 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5179614d]
2025-04-21 20:19:34.171 [http-nio-8080-exec-5] DEBUG com.community.waste.service.impl.UserServiceImpl - 校验密码
2025-04-21 20:19:34.172 [http-nio-8080-exec-5] INFO  com.community.waste.service.impl.UserServiceImpl - 更新用户最后登录时间，用户ID: 1
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c709e1b] was not registered for synchronization because synchronization is not active
2025-04-21 20:19:34.172 [http-nio-8080-exec-5] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@11182955 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: UPDATE user SET last_login_time = NOW() WHERE id = ?
==> Parameters: 1(Integer)
<==    Updates: 1
2025-04-21 20:19:34.181 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: UPDATE user SET last_login_time = NOW() WHERE id = 1
2025-04-21 20:19:34.181 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.UserMapper.updateLastLoginTime
2025-04-21 20:19:34.181 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 9 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c709e1b]
2025-04-21 20:19:34.181 [http-nio-8080-exec-5] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT COUNT(*) as connections FROM information_schema.PROCESSLIST WHERE DB = DATABASE()]
2025-04-21 20:19:34.181 [http-nio-8080-exec-5] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:19:34.182 [http-nio-8080-exec-5] DEBUG org.springframework.jdbc.core.JdbcTemplate - SQLWarning ignored: SQL state 'HY000', error code '1287', message ['INFORMATION_SCHEMA.PROCESSLIST' is deprecated and will be removed in a future release. Please use performance_schema.processlist instead]
2025-04-21 20:19:34.182 [http-nio-8080-exec-5] INFO  com.community.waste.util.DbLogUtil - 当前活动连接数: 5
2025-04-21 20:19:34.182 [http-nio-8080-exec-5] INFO  com.community.waste.service.impl.UserServiceImpl - 用户登录成功，用户ID: 1
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66566d86] was not registered for synchronization because synchronization is not active
2025-04-21 20:19:59.525 [http-nio-8080-exec-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@801962743 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
==> Parameters: 
<==    Columns: id, name, description, examples, image1, image2, image3, create_time, update_time
<==        Row: 1, 可回收物, <<BLOB>>, <<BLOB>>, /images/recyclable1.jpg, /images/recyclable2.jpg, /images/recyclable3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 2, 厨余垃圾, <<BLOB>>, <<BLOB>>, /images/food1.jpg, /images/food2.jpg, /images/food3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 3, 有害垃圾, <<BLOB>>, <<BLOB>>, /images/hazardous1.jpg, /images/hazardous2.jpg, /images/hazardous3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 4, 其他垃圾, <<BLOB>>, <<BLOB>>, /images/other1.jpg, /images/other2.jpg, /images/other3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 5, 可回收物, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 6, 厨余垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 7, 有害垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 8, 其他垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==      Total: 8
2025-04-21 20:19:59.537 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
2025-04-21 20:19:59.538 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteCategoryMapper.selectAll
2025-04-21 20:19:59.538 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 13 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66566d86]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c264d30] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:14.221 [http-nio-8080-exec-5] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@739471494 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
==> Parameters: 
Creating a new SqlSession
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f8f72be] was not registered for synchronization because synchronization is not active
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75b998b6] was not registered for synchronization because synchronization is not active
<==    Columns: id, name, description, examples, image1, image2, image3, create_time, update_time
2025-04-21 20:20:14.225 [http-nio-8080-exec-6] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:20:14.225 [http-nio-8080-exec-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
<==        Row: 1, 可回收物, <<BLOB>>, <<BLOB>>, /images/recyclable1.jpg, /images/recyclable2.jpg, /images/recyclable3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
JDBC Connection [HikariProxyConnection@57356070 wrapping com.mysql.cj.jdbc.ConnectionImpl@62a87c43] will not be managed by Spring
JDBC Connection [HikariProxyConnection@180019301 wrapping com.mysql.cj.jdbc.ConnectionImpl@23957678] will not be managed by Spring
==>  Preparing: SELECT IFNULL(SUM(weight), 0) FROM waste_record WHERE user_id = ?
==>  Preparing: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id WHERE r.user_id = ? ORDER BY r.create_time DESC
==> Parameters: 1(Integer)
==> Parameters: 1(Integer)
<==        Row: 2, 厨余垃圾, <<BLOB>>, <<BLOB>>, /images/food1.jpg, /images/food2.jpg, /images/food3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 3, 有害垃圾, <<BLOB>>, <<BLOB>>, /images/hazardous1.jpg, /images/hazardous2.jpg, /images/hazardous3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 4, 其他垃圾, <<BLOB>>, <<BLOB>>, /images/other1.jpg, /images/other2.jpg, /images/other3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 5, 可回收物, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 6, 厨余垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 7, 有害垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 8, 其他垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==      Total: 8
2025-04-21 20:20:14.230 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
2025-04-21 20:20:14.231 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteCategoryMapper.selectAll
2025-04-21 20:20:14.231 [http-nio-8080-exec-5] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 9 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c264d30]
<==    Columns: IFNULL(SUM(weight), 0)
<==      Total: 0
2025-04-21 20:20:14.246 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id WHERE r.user_id = 1 ORDER BY r.create_time DESC
2025-04-21 20:20:14.246 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.selectByUserId
2025-04-21 20:20:14.246 [http-nio-8080-exec-1] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 21 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75b998b6]
<==        Row: 0.00
<==      Total: 1
2025-04-21 20:20:14.252 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT IFNULL(SUM(weight), 0) FROM waste_record WHERE user_id = 1
2025-04-21 20:20:14.252 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.sumWeightByUserId
2025-04-21 20:20:14.252 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 27 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f8f72be]
Creating a new SqlSession
Creating a new SqlSession
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b86439d] was not registered for synchronization because synchronization is not active
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@197f6de4] was not registered for synchronization because synchronization is not active
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8ffcefb] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:29.735 [http-nio-8080-exec-10] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:20:29.735 [http-nio-8080-exec-7] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:20:29.735 [http-nio-8080-exec-6] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@1694631137 wrapping com.mysql.cj.jdbc.ConnectionImpl@23957678] will not be managed by Spring
JDBC Connection [HikariProxyConnection@1322062229 wrapping com.mysql.cj.jdbc.ConnectionImpl@62a87c43] will not be managed by Spring
JDBC Connection [HikariProxyConnection@1287523156 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
==>  Preparing: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id WHERE r.user_id = ? ORDER BY r.create_time DESC
==>  Preparing: SELECT IFNULL(SUM(weight), 0) FROM waste_record WHERE user_id = ?
==> Parameters: 
==> Parameters: 1(Integer)
==> Parameters: 1(Integer)
<==      Total: 0
<==    Columns: IFNULL(SUM(weight), 0)
<==    Columns: id, name, description, examples, image1, image2, image3, create_time, update_time
<==        Row: 0.00
<==      Total: 1
<==        Row: 1, 可回收物, <<BLOB>>, <<BLOB>>, /images/recyclable1.jpg, /images/recyclable2.jpg, /images/recyclable3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
2025-04-21 20:20:29.739 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT IFNULL(SUM(weight), 0) FROM waste_record WHERE user_id = 1
2025-04-21 20:20:29.739 [http-nio-8080-exec-7] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id WHERE r.user_id = 1 ORDER BY r.create_time DESC
2025-04-21 20:20:29.739 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.sumWeightByUserId
2025-04-21 20:20:29.739 [http-nio-8080-exec-7] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.selectByUserId
2025-04-21 20:20:29.740 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 4 毫秒
2025-04-21 20:20:29.740 [http-nio-8080-exec-7] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 4 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@197f6de4]
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b86439d]
<==        Row: 2, 厨余垃圾, <<BLOB>>, <<BLOB>>, /images/food1.jpg, /images/food2.jpg, /images/food3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 3, 有害垃圾, <<BLOB>>, <<BLOB>>, /images/hazardous1.jpg, /images/hazardous2.jpg, /images/hazardous3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 4, 其他垃圾, <<BLOB>>, <<BLOB>>, /images/other1.jpg, /images/other2.jpg, /images/other3.jpg, 2025-04-17 20:33:11, 2025-04-17 20:33:11
<==        Row: 5, 可回收物, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 6, 厨余垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 7, 有害垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==        Row: 8, 其他垃圾, <<BLOB>>, <<BLOB>>, null, null, null, 2025-04-20 16:33:08, 2025-04-20 16:33:08
<==      Total: 8
2025-04-21 20:20:29.745 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT id, name, description, examples, image1, image2, image3, create_time, update_time FROM waste_category ORDER BY id ASC
2025-04-21 20:20:29.745 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteCategoryMapper.selectAll
2025-04-21 20:20:29.745 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 10 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8ffcefb]
Creating a new SqlSession
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2adf81f] was not registered for synchronization because synchronization is not active
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59b1fd3e] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:36.829 [http-nio-8080-exec-10] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:20:36.829 [http-nio-8080-exec-8] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@994294689 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
JDBC Connection [HikariProxyConnection@1202681390 wrapping com.mysql.cj.jdbc.ConnectionImpl@62a87c43] will not be managed by Spring
==>  Preparing: SELECT c.id as categoryId, c.name as categoryName, COUNT(r.id) as recordCount, IFNULL(SUM(r.weight), 0) as totalWeight FROM waste_record r LEFT JOIN waste_category c ON r.category_id = c.id GROUP BY c.id, c.name
==>  Preparing: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id ORDER BY r.create_time DESC
==> Parameters: 
==> Parameters: 
Creating a new SqlSession
<==      Total: 0
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d73ea68] was not registered for synchronization because synchronization is not active
<==      Total: 0
2025-04-21 20:20:36.831 [http-nio-8080-exec-6] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:20:36.831 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT c.id as categoryId, c.name as categoryName, COUNT(r.id) as recordCount, IFNULL(SUM(r.weight), 0) as totalWeight FROM waste_record r LEFT JOIN waste_category c ON r.category_id = c.id GROUP BY c.id, c.name
2025-04-21 20:20:36.831 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT r.id, r.user_id, r.category_id, r.weight, r.description, r.location, r.image, r.create_time, u.id as u_id, u.username as u_username, u.role as u_role, c.id as c_id, c.name as c_name FROM waste_record r LEFT JOIN user u ON r.user_id = u.id LEFT JOIN waste_category c ON r.category_id = c.id ORDER BY r.create_time DESC
2025-04-21 20:20:36.831 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.selectAll
2025-04-21 20:20:36.831 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 2 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2adf81f]
2025-04-21 20:20:36.831 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.countGroupByCategory
2025-04-21 20:20:36.832 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 2 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59b1fd3e]
JDBC Connection [HikariProxyConnection@2064910826 wrapping com.mysql.cj.jdbc.ConnectionImpl@23957678] will not be managed by Spring
==>  Preparing: SELECT DATE_FORMAT(r.create_time, '%Y-%m-%d') as date, COUNT(r.id) as recordCount, IFNULL(SUM(r.weight), 0) as totalWeight FROM waste_record r WHERE r.create_time >= DATE_SUB(CURDATE(), INTERVAL ? DAY) GROUP BY DATE_FORMAT(r.create_time, '%Y-%m-%d') ORDER BY date
==> Parameters: 30(Integer)
<==      Total: 0
2025-04-21 20:20:36.834 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT DATE_FORMAT(r.create_time, '%Y-%m-%d') as date, COUNT(r.id) as recordCount, IFNULL(SUM(r.weight), 0) as totalWeight FROM waste_record r WHERE r.create_time >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) GROUP BY DATE_FORMAT(r.create_time, '%Y-%m-%d') ORDER BY date
2025-04-21 20:20:36.834 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.WasteRecordMapper.countGroupByDate
2025-04-21 20:20:36.834 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 3 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d73ea68]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f07b213] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:44.691 [http-nio-8080-exec-10] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@1779933486 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time >= NOW() ORDER BY a.start_time ASC
==> Parameters: 
<==      Total: 0
2025-04-21 20:20:44.692 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time >= NOW() ORDER BY a.start_time ASC
2025-04-21 20:20:44.693 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.ActivityMapper.selectByTimeOrder
2025-04-21 20:20:44.693 [http-nio-8080-exec-10] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 17 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f07b213]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ce4648e] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:45.417 [http-nio-8080-exec-6] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@1854340048 wrapping com.mysql.cj.jdbc.ConnectionImpl@23957678] will not be managed by Spring
==>  Preparing: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time < NOW() ORDER BY a.start_time ASC
==> Parameters: 
<==    Columns: id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time, publisher_id, publisher_username
<==        Row: 1, 垃圾分类知识讲座, <<BLOB>>, 社区活动中心, 2023-07-15 09:00:00, 2023-07-15 11:00:00, 请致电社区办公室（电话：12345678）或扫描海报上的二维码进行报名, 1, 2025-04-17 20:33:12, 2025-04-17 20:33:12, 1, admin
<==        Row: 2, 垃圾分类实践活动, <<BLOB>>, 社区广场, 2023-07-20 14:00:00, 2023-07-20 16:00:00, 活动现场报名参加, 2, 2025-04-17 20:33:12, 2025-04-17 20:33:12, 2, manager
<==      Total: 2
2025-04-21 20:20:45.423 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time < NOW() ORDER BY a.start_time ASC
2025-04-21 20:20:45.423 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.ActivityMapper.selectByTimeOrder
2025-04-21 20:20:45.423 [http-nio-8080-exec-6] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 7 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ce4648e]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30296a2] was not registered for synchronization because synchronization is not active
2025-04-21 20:20:47.288 [http-nio-8080-exec-9] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@1005626731 wrapping com.mysql.cj.jdbc.ConnectionImpl@664a9613] will not be managed by Spring
==>  Preparing: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.id = ?
==> Parameters: 1(Integer)
<==    Columns: id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time, publisher_id, publisher_username
<==        Row: 1, 垃圾分类知识讲座, <<BLOB>>, 社区活动中心, 2023-07-15 09:00:00, 2023-07-15 11:00:00, 请致电社区办公室（电话：12345678）或扫描海报上的二维码进行报名, 1, 2025-04-17 20:33:12, 2025-04-17 20:33:12, 1, admin
<==      Total: 1
2025-04-21 20:20:47.294 [http-nio-8080-exec-9] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.id = 1
2025-04-21 20:20:47.294 [http-nio-8080-exec-9] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.ActivityMapper.selectById
2025-04-21 20:20:47.294 [http-nio-8080-exec-9] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 6 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30296a2]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210b87c4] was not registered for synchronization because synchronization is not active
2025-04-21 20:21:04.426 [http-nio-8080-exec-8] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
JDBC Connection [HikariProxyConnection@291035385 wrapping com.mysql.cj.jdbc.ConnectionImpl@62a87c43] will not be managed by Spring
==>  Preparing: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time >= NOW() ORDER BY a.start_time ASC
==> Parameters: 
<==      Total: 0
2025-04-21 20:21:04.428 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行SQL: SELECT a. id, title, content, location, start_time, end_time, registration_method, publisher_id, publish_time, update_time , u.id AS publisher_id, u.username AS publisher_username FROM activity a LEFT JOIN user u ON a.publisher_id = u.id WHERE a.end_time >= NOW() ORDER BY a.start_time ASC
2025-04-21 20:21:04.429 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - SQL ID: com.community.waste.mapper.ActivityMapper.selectByTimeOrder
2025-04-21 20:21:04.429 [http-nio-8080-exec-8] INFO  com.community.waste.config.SqlMonitorInterceptor - 执行耗时: 3 毫秒
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@210b87c4]
2025-04-21 20:28:41.675 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 开始执行数据库连接监控任务
2025-04-21 20:28:41.677 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT COUNT(*) as connections FROM information_schema.PROCESSLIST WHERE DB = DATABASE()]
2025-04-21 20:28:41.678 [scheduling-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:28:41.691 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - SQLWarning ignored: SQL state 'HY000', error code '1287', message ['INFORMATION_SCHEMA.PROCESSLIST' is deprecated and will be removed in a future release. Please use performance_schema.processlist instead]
2025-04-21 20:28:41.692 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - 当前活动连接数: 5
2025-04-21 20:28:41.692 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 数据库连接监控任务执行完成
2025-04-21 20:38:41.690 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 开始执行数据库连接监控任务
2025-04-21 20:38:41.692 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - Executing SQL query [SELECT COUNT(*) as connections FROM information_schema.PROCESSLIST WHERE DB = DATABASE()]
2025-04-21 20:38:41.692 [scheduling-1] DEBUG o.springframework.jdbc.datasource.DataSourceUtils - Fetching JDBC Connection from DataSource
2025-04-21 20:38:41.701 [scheduling-1] DEBUG org.springframework.jdbc.core.JdbcTemplate - SQLWarning ignored: SQL state 'HY000', error code '1287', message ['INFORMATION_SCHEMA.PROCESSLIST' is deprecated and will be removed in a future release. Please use performance_schema.processlist instead]
2025-04-21 20:38:41.702 [scheduling-1] INFO  com.community.waste.util.DbLogUtil - 当前活动连接数: 5
2025-04-21 20:38:41.702 [scheduling-1] INFO  com.community.waste.task.DatabaseMonitorTask - 数据库连接监控任务执行完成
